2025-06-06 09:12:21,860 INFO    MainThread:437761 [wandb_setup.py:_flush():81] Current SDK version is 0.20.1
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_setup.py:_flush():81] Configure stats pid to 437761
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_setup.py:_flush():81] Loading settings from /home/geiger/gwb345/.config/wandb/settings
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_setup.py:_flush():81] Loading settings from /mnt/lustre/work/geiger/gwb345/LLMCBench/wandb/settings
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_setup.py:_flush():81] Loading settings from environment variables
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_init.py:setup_run_log_directory():703] Logging user logs to /mnt/lustre/work/geiger/gwb345/LLMCBench/wandb/run-20250606_091221-6i986j1o/logs/debug.log
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_init.py:setup_run_log_directory():704] Logging internal logs to /mnt/lustre/work/geiger/gwb345/LLMCBench/wandb/run-20250606_091221-6i986j1o/logs/debug-internal.log
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_init.py:init():831] calling init triggers
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_init.py:init():836] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-06-06 09:12:21,861 INFO    MainThread:437761 [wandb_init.py:init():872] starting backend
2025-06-06 09:12:22,104 INFO    MainThread:437761 [wandb_init.py:init():875] sending inform_init request
2025-06-06 09:12:22,116 INFO    MainThread:437761 [wandb_init.py:init():883] backend started and connected
2025-06-06 09:12:22,118 INFO    MainThread:437761 [wandb_init.py:init():956] updated telemetry
2025-06-06 09:12:22,130 INFO    MainThread:437761 [wandb_init.py:init():980] communicating run to backend with 90.0 second timeout
2025-06-06 09:12:22,676 INFO    MainThread:437761 [wandb_init.py:init():1032] starting run threads in backend
2025-06-06 09:12:22,899 INFO    MainThread:437761 [wandb_run.py:_console_start():2453] atexit reg
2025-06-06 09:12:22,899 INFO    MainThread:437761 [wandb_run.py:_redirect():2301] redirect: wrap_raw
2025-06-06 09:12:22,899 INFO    MainThread:437761 [wandb_run.py:_redirect():2370] Wrapping output streams.
2025-06-06 09:12:22,899 INFO    MainThread:437761 [wandb_run.py:_redirect():2393] Redirects installed.
2025-06-06 09:12:22,908 INFO    MainThread:437761 [wandb_init.py:init():1078] run started, returning control to user process
2025-06-06 09:13:38,384 INFO    MainThread:437761 [wandb_run.py:_config_callback():1358] config_cb None None {'task_configs': {'wikitext': {'task': 'wikitext', 'dataset_path': 'EleutherAI/wikitext_document_level', 'dataset_name': 'wikitext-2-raw-v1', 'dataset_kwargs': {'trust_remote_code': True}, 'training_split': 'train', 'validation_split': 'validation', 'test_split': 'test', 'doc_to_text': '', 'doc_to_target': 'def wikitext_detokenizer(doc):\n    string = doc["page"]\n    # contractions\n    string = string.replace("s \'", "s\'")\n    string = re.sub(r"/\' [0-9]/", r"/\'[0-9]/", string)\n    # number separators\n    string = string.replace(" @-@ ", "-")\n    string = string.replace(" @,@ ", ",")\n    string = string.replace(" @.@ ", ".")\n    # punctuation\n    string = string.replace(" : ", ": ")\n    string = string.replace(" ; ", "; ")\n    string = string.replace(" . ", ". ")\n    string = string.replace(" ! ", "! ")\n    string = string.replace(" ? ", "? ")\n    string = string.replace(" , ", ", ")\n    # double brackets\n    string = re.sub(r"\\(\\s*([^\\)]*?)\\s*\\)", r"(\\1)", string)\n    string = re.sub(r"\\[\\s*([^\\]]*?)\\s*\\]", r"[\\1]", string)\n    string = re.sub(r"{\\s*([^}]*?)\\s*}", r"{\\1}", string)\n    string = re.sub(r"\\"\\s*([^\\"]*?)\\s*\\"", r\'"\\1"\', string)\n    string = re.sub(r"\'\\s*([^\']*?)\\s*\'", r"\'\\1\'", string)\n    # miscellaneous\n    string = string.replace("= = = =", "====")\n    string = string.replace("= = =", "===")\n    string = string.replace("= =", "==")\n    string = string.replace(" " + chr(176) + " ", chr(176))\n    string = string.replace(" \\n", "\\n")\n    string = string.replace("\\n ", "\\n")\n    string = string.replace(" N ", " 1 ")\n    string = string.replace(" \'s", "\'s")\n\n    return string\n', 'unsafe_code': False, 'process_results': 'def process_results(doc, results):\n    (loglikelihood,) = results\n    # IMPORTANT: wikitext counts number of words in *original doc before detokenization*\n    _words = len(re.split(r"\\s+", doc["page"]))\n    _bytes = len(doc["page"].encode("utf-8"))\n    return {\n        "word_perplexity": (loglikelihood, _words),\n        "byte_perplexity": (loglikelihood, _bytes),\n        "bits_per_byte": (loglikelihood, _bytes),\n    }\n', 'description': '', 'target_delimiter': ' ', 'fewshot_delimiter': '\n\n', 'num_fewshot': 0, 'metric_list': [{'metric': 'word_perplexity'}, {'metric': 'byte_perplexity'}, {'metric': 'bits_per_byte'}], 'output_type': 'loglikelihood_rolling', 'repeats': 1, 'should_decontaminate': True, 'doc_to_decontamination_query': '{{page}}', 'metadata': {'version': 2.0, 'pretrained': '/mnt/lustre/work/geiger/gwb345/models/llama-3.1-8b-hf', 'device_map': 'auto'}}}, 'cli_configs': {'model': 'hf', 'model_args': 'pretrained=/mnt/lustre/work/geiger/gwb345/models/llama-3.1-8b-hf,device_map=auto', 'model_num_parameters': 8030261248, 'model_dtype': 'torch.bfloat16', 'model_revision': 'main', 'model_sha': '', 'batch_size': 'auto', 'batch_sizes': [], 'device': None, 'use_cache': None, 'limit': None, 'bootstrap_iters': 100000, 'gen_kwargs': None, 'random_seed': 0, 'numpy_seed': 1234, 'torch_seed': 1234, 'fewshot_seed': 1234}}
2025-06-06 09:13:39,216 INFO    MainThread:437761 [wandb_run.py:_finish():2219] finishing run jonathan-von-rad/benchmark-tests/6i986j1o
2025-06-06 09:13:39,216 INFO    MainThread:437761 [wandb_run.py:_atexit_cleanup():2418] got exitcode: 0
2025-06-06 09:13:39,216 INFO    MainThread:437761 [wandb_run.py:_restore():2400] restore
2025-06-06 09:13:39,217 INFO    MainThread:437761 [wandb_run.py:_restore():2406] restore done
2025-06-06 09:13:41,084 INFO    MainThread:437761 [wandb_run.py:_footer_history_summary_info():4000] rendering history
2025-06-06 09:13:41,085 INFO    MainThread:437761 [wandb_run.py:_footer_history_summary_info():4032] rendering summary
2025-06-06 09:13:41,085 INFO    MainThread:437761 [wandb_run.py:_footer_sync_info():3961] logging synced files
